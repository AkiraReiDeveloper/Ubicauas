





let map;
let userLocation = { lat: 23.2319822, lng: -106.4228887 }; // Ubicación inicial predeterminada
let userMarker;
let activePolyline;
let remainingPathGlobal = []; // Ruta restante
let userToNextPointPolyline; // Línea del usuario al siguiente punto
let uasPolygon; // Polígono del campus

const entrances = [
    { lat: 23.231975879019632, lng: -106.42292258616281, name: "Entrada 1" },
    { lat: 23.231363495545406, lng: -106.42337220653123, name: "Entrada 2" },
    { lat: 23.230448502004883, lng: -106.42674029892541, name: "Entrada 3" },
    { lat: 23.231243648265867, lng: -106.42799959886528, name: "Entrada 4" }
];

const destinations = {
    UAGYNM: { lat: 23.2313054059438, lng: -106.42617273640757, name: "UAGYNM" }
};

const routes = [
    // Rutas desde Entrada 1
    // Ruta existente a UAGYNM desde Entrada 1 v1
    [
        { lat: 23.23196923163086, lng: -106.42297557745351 },
        { lat: 23.23197436099668, lng: -106.42300508219596 },
        { lat: 23.23198168866179, lng: -106.42303059981103 },
        { lat: 23.231965567798017, lng: -106.42307126851007 },
        { lat: 23.231886428983948, lng: -106.4232626506232 },
        { lat: 23.23186298043743, lng: -106.42326903002697 },
        { lat: 23.231800695215753, lng: -106.42328418111093 },
        { lat: 23.231715694160453, lng: -106.42330491417317 },
        { lat: 23.231644615650243, lng: -106.42334159574486 },
        { lat: 23.2316885817435, lng: -106.42341735116464 },
        { lat: 23.231724487375583, lng: -106.42348433490423 },
        { lat: 23.231748668714204, lng: -106.42355929289855 },
        { lat: 23.23175013424973, lng: -106.42364222514756 },
        { lat: 23.23174720317865, lng: -106.42371399343997 },//
        { lat: 23.231750134249282, lng: -106.42378576176186 },
        { lat: 23.231755996391254, lng: -106.42388145281842 },
        { lat: 23.231760392997572, lng: -106.4239707644712 },
        { lat: 23.231764056836038, lng: -106.42406087354948 },
        { lat: 23.231770651745062, lng: -106.42412865471455 },
        { lat: 23.231775048350883, lng: -106.4242299277494 },
        { lat: 23.231777979421356, lng: -106.42432641623142 },
        { lat: 23.23178530709725, lng: -106.42440695620402 },//
        { lat: 23.23178897093414, lng: -106.42447234511782 },
        { lat: 23.231790436469232, lng: -106.42456245419609 },
        { lat: 23.231787505399026, lng: -106.42467010663471 },
        { lat: 23.23178091049086, lng: -106.42474107750168 },
        { lat: 23.231790436469232, lng: -106.42484952736577 },
        { lat: 23.23179410030688, lng: -106.4249157136799 },
        { lat: 23.23179556584212, lng: -106.42501858158094 },
        { lat: 23.23181095395902, lng: -106.4251031086809 },
        { lat: 23.231756729158295, lng: -106.42517886410069 },
        { lat: 23.23167246084318, lng: -106.42524824011669 },
        { lat: 23.2316819868293, lng: -106.42529050366667 },
        { lat: 23.23169078004641, lng: -106.42539257414903 },
        { lat: 23.231700306031215, lng: -106.42550421371503 },
        { lat: 23.231708366479367, lng: -106.4256246249612 },
        { lat: 23.231717159694977, lng: -106.42570117780645 },
        { lat: 23.231721556302567, lng: -106.42575938986585 },
        { lat: 23.231646725772936, lng: -106.42577630016079 },
        { lat: 23.231583512012428, lng: -106.42580562113862 },
        { lat: 23.231517189346267, lng: -106.42580674886855 },
        { lat: 23.231442576307458, lng: -106.42582592027713 },
        { lat: 23.231341019600958, lng: -106.42590147819526 },
        { lat: 23.2313047493311, lng: -106.42593418236282 },
        { lat: 23.23129853156955, lng: -106.42603906124508 },
        { lat: 23.2313047493311, lng: -106.4261157468794 },
        { lat: 23.23131096709234, lng: -106.42615634515639 },
        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 1 v2
    [
        { lat: 23.23196923163086, lng: -106.42297557745351 },
        { lat: 23.23197436099668, lng: -106.42300508219596 },
        { lat: 23.23198168866179, lng: -106.42303059981103 },
        { lat: 23.231965567798017, lng: -106.42307126851007 },
        { lat: 23.231886428983948, lng: -106.4232626506232 },
        { lat: 23.23186298043743, lng: -106.42326903002697 },
        { lat: 23.231800695215753, lng: -106.42328418111093 },
        { lat: 23.231715694160453, lng: -106.42330491417317 },
        { lat: 23.231644615650243, lng: -106.42334159574486 },
        { lat: 23.2316885817435, lng: -106.42341735116464 },
        { lat: 23.231724487375583, lng: -106.42348433490423 },
        { lat: 23.231748668714204, lng: -106.42355929289855 },
        { lat: 23.23175013424973, lng: -106.42364222514756 },
        { lat: 23.23174720317865, lng: -106.42371399343997 },//
        { lat: 23.231778336227922, lng: -106.4237142289087 },
        { lat: 23.231802367310284, lng: -106.42371624056535 },
        { lat: 23.231837489653635, lng: -106.42373367492308 },
        { lat: 23.231852894187288, lng: -106.42377591971295 },
        { lat: 23.23186829871916, lng: -106.42383157554724 },
        { lat: 23.231877541437424, lng: -106.42390935960479 },
        { lat: 23.2318874003362, lng: -106.42396233323021 },
        { lat: 23.23189171360419, lng: -106.42401128354228 },
        { lat: 23.23189479450981, lng: -106.42406962158543 },
        { lat: 23.231896026873887, lng: -106.4240749860125 },
        { lat: 23.231902804865932, lng: -106.42413935902566 },
        { lat: 23.23190588577129, lng: -106.42419568541216 },
        { lat: 23.231906501952366, lng: -106.42423457744093 },
        { lat: 23.23190218868485, lng: -106.4242795044397 },
        { lat: 23.2318984915983, lng: -106.42432778419955 },
        { lat: 23.231891713606032, lng: -106.4243653351239 },
        { lat: 23.231875076714473, lng: -106.42438679279495 },
        { lat: 23.23185042946387, lng: -106.42440020383935 },
        { lat: 23.23183071166013, lng: -106.42440623880933 },
        { lat: 23.231805448219816, lng: -106.42441026212266 },
        { lat: 23.23178530709725, lng: -106.42440695620402 },//
        { lat: 23.23178897093414, lng: -106.42447234511782 },
        { lat: 23.231790436469232, lng: -106.42456245419609 },
        { lat: 23.231787505399026, lng: -106.42467010663471 },
        { lat: 23.23178091049086, lng: -106.42474107750168 },
        { lat: 23.231790436469232, lng: -106.42484952736577 },
        { lat: 23.23179410030688, lng: -106.4249157136799 },
        { lat: 23.23179556584212, lng: -106.42501858158094 },
        { lat: 23.23181095395902, lng: -106.4251031086809 },
        { lat: 23.231756729158295, lng: -106.42517886410069 },
        { lat: 23.23167246084318, lng: -106.42524824011669 },
        { lat: 23.2316819868293, lng: -106.42529050366667 },
        { lat: 23.23169078004641, lng: -106.42539257414903 },
        { lat: 23.231700306031215, lng: -106.42550421371503 },
        { lat: 23.231708366479367, lng: -106.4256246249612 },
        { lat: 23.231717159694977, lng: -106.42570117780645 },
        { lat: 23.231721556302567, lng: -106.42575938986585 },
        { lat: 23.231646725772936, lng: -106.42577630016079 },
        { lat: 23.231583512012428, lng: -106.42580562113862 },
        { lat: 23.231517189346267, lng: -106.42580674886855 },
        { lat: 23.231442576307458, lng: -106.42582592027713 },
        { lat: 23.231341019600958, lng: -106.42590147819526 },
        { lat: 23.2313047493311, lng: -106.42593418236282 },
        { lat: 23.23129853156955, lng: -106.42603906124508 },
        { lat: 23.2313047493311, lng: -106.4261157468794 },
        { lat: 23.23131096709234, lng: -106.42615634515639 },
        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 1 v3
    [
        { lat: 23.23196923163086, lng: -106.42297557745351 },
        { lat: 23.23197436099668, lng: -106.42300508219596 },
        { lat: 23.23198168866179, lng: -106.42303059981103 },
        { lat: 23.231965567798017, lng: -106.42307126851007 },
        { lat: 23.231886428983948, lng: -106.4232626506232 },
        { lat: 23.23186298043743, lng: -106.42326903002697 },
        { lat: 23.231800695215753, lng: -106.42328418111093 },
        { lat: 23.231715694160453, lng: -106.42330491417317 },
        { lat: 23.231644615650243, lng: -106.42334159574486 },
        { lat: 23.2316885817435, lng: -106.42341735116464 },
        { lat: 23.231724487375583, lng: -106.42348433490423 },
        { lat: 23.231748668714204, lng: -106.42355929289855 },
        { lat: 23.23175013424973, lng: -106.42364222514756 },
        { lat: 23.23174720317865, lng: -106.42371399343997 },//
        { lat: 23.231696086495955, lng: -106.42371888155007 },
        { lat: 23.231675136305153, lng: -106.4237269281767 },
        { lat: 23.231649872835398, lng: -106.42373966866892 },
        { lat: 23.23162214463138, lng: -106.42377453738436 },
        { lat: 23.23160550770621, lng: -106.42381409996536 },
        { lat: 23.231599345881534, lng: -106.42386707359076 },
        { lat: 23.231595032604112, lng: -106.42391334169396 },
        { lat: 23.23159564878662, lng: -106.42396028034938 },
        { lat: 23.231599962064017, lng: -106.42399783127371 },
        { lat: 23.23159811351658, lng: -106.42404678158579 },
        { lat: 23.231602426793906, lng: -106.42410444907675 },
        { lat: 23.2316098209833, lng: -106.42417418650766 },
        { lat: 23.23161475044268, lng: -106.42423252455082 },
        { lat: 23.231622760813764, lng: -106.42429019204177 },
        { lat: 23.231635084460645, lng: -106.42433444848831 },
        { lat: 23.23164617574187, lng: -106.42437266996485 },
        { lat: 23.23166589357288, lng: -106.424397480397 },
        { lat: 23.23169423794984, lng: -106.42440820923254 },
        { lat: 23.231731825049145, lng: -106.42441290309809 },
        { lat: 23.231752775231055, lng: -106.42441022088919 },
        { lat: 23.23178530709725, lng: -106.42440695620402 },//
        { lat: 23.23178897093414, lng: -106.42447234511782 },
        { lat: 23.231790436469232, lng: -106.42456245419609 },
        { lat: 23.231787505399026, lng: -106.42467010663471 },
        { lat: 23.23178091049086, lng: -106.42474107750168 },
        { lat: 23.231790436469232, lng: -106.42484952736577 },
        { lat: 23.23179410030688, lng: -106.4249157136799 },
        { lat: 23.23179556584212, lng: -106.42501858158094 },
        { lat: 23.23181095395902, lng: -106.4251031086809 },
        { lat: 23.231756729158295, lng: -106.42517886410069 },
        { lat: 23.23167246084318, lng: -106.42524824011669 },
        { lat: 23.2316819868293, lng: -106.42529050366667 },
        { lat: 23.23169078004641, lng: -106.42539257414903 },
        { lat: 23.231700306031215, lng: -106.42550421371503 },
        { lat: 23.231708366479367, lng: -106.4256246249612 },
        { lat: 23.231717159694977, lng: -106.42570117780645 },
        { lat: 23.231721556302567, lng: -106.42575938986585 },
        { lat: 23.231646725772936, lng: -106.42577630016079 },
        { lat: 23.231583512012428, lng: -106.42580562113862 },
        { lat: 23.231517189346267, lng: -106.42580674886855 },
        { lat: 23.231442576307458, lng: -106.42582592027713 },
        { lat: 23.231341019600958, lng: -106.42590147819526 },
        { lat: 23.2313047493311, lng: -106.42593418236282 },
        { lat: 23.23129853156955, lng: -106.42603906124508 },
        { lat: 23.2313047493311, lng: -106.4261157468794 },
        { lat: 23.23131096709234, lng: -106.42615634515639 },
        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 1 v4
    [
        { lat: 23.23196923163086, lng: -106.42297557745351 },
        { lat: 23.232012495438486, lng: -106.42306106093575 },
        { lat: 23.232042072102743, lng: -106.42309324744232 },
        { lat: 23.232081507644875, lng: -106.42313348057553 },
        { lat: 23.232140660936228, lng: -106.42317907812652 },
        { lat: 23.232162843413732, lng: -106.42323272230414 },
        { lat: 23.232258967440284, lng: -106.42326490881071 },
        { lat: 23.23236987969262, lng: -106.4233668327482 },
        { lat: 23.232478327139102, lng: -106.42353581190771 },
        { lat: 23.232599098055356, lng: -106.42371015548498 },
        { lat: 23.232697686487572, lng: -106.42388181687362 },
        { lat: 23.23286528663792, lng: -106.42413394450844 },
        { lat: 23.23293183369808, lng: -106.42424927949033 },
        { lat: 23.233025492467263, lng: -106.42439143656102 },
        { lat: 23.23310682766087, lng: -106.42454164025838 },
        { lat: 23.23320788040812, lng: -106.42469184395573 },
        { lat: 23.233289215490576, lng: -106.4248259543998 },
        { lat: 23.23334343885135, lng: -106.42494128938168 },
        { lat: 23.233387803402863, lng: -106.42505394215469 },
        { lat: 23.23343463263568, lng: -106.42516927713659 },
        { lat: 23.23349871471713, lng: -106.42533289187831 },
        { lat: 23.23357265554211, lng: -106.42551796429113 },
        { lat: 23.233602231869128, lng: -106.42562525269354 },
        { lat: 23.233617020025935, lng: -106.42583982940401 },
        { lat: 23.233597302483158, lng: -106.42596589322143 },
        { lat: 23.233591243102218, lng: -106.42603399179329 },
        { lat: 23.233500049424883, lng: -106.42603667400215 },
        { lat: 23.233403926292127, lng: -106.42604740283768 },
        { lat: 23.233334914769518, lng: -106.42605544946434 },
        { lat: 23.233199356317623, lng: -106.42606886050874 },
        { lat: 23.23308598005214, lng: -106.42607154271762 },
        { lat: 23.233002180141842, lng: -106.42609031817977 },
        { lat: 23.232903591944705, lng: -106.42608495376201 },
        { lat: 23.232812397797524, lng: -106.4260742249265 },
        { lat: 23.232728597715447, lng: -106.4260581316732 },
        { lat: 23.232627544605318, lng: -106.42604203841992 },
        { lat: 23.232528956131468, lng: -106.4260447206288 },
        { lat: 23.23244762058572, lng: -106.42604740283768 },
        { lat: 23.23234163783051, lng: -106.42606081388209 },
        { lat: 23.232267696323557, lng: -106.42607690713537 },
        { lat: 23.232169107583896, lng: -106.42607154271762 },
        { lat: 23.232100095422812, lng: -106.42608227155314 },
        { lat: 23.2319891829463, lng: -106.42609568259755 },
        { lat: 23.231986718207843, lng: -106.42609031820918 },
        { lat: 23.23189305870973, lng: -106.42609836483582 },
        { lat: 23.231838834759742, lng: -106.42609836483582 },
        { lat: 23.23176242824735, lng: -106.42610909367136 },
        { lat: 23.231708204244296, lng: -106.42610909367136 },
        { lat: 23.231653980219193, lng: -106.42612518692464 },
        { lat: 23.231567714679347, lng: -106.42615469122234 },
        { lat: 23.231508561134067, lng: -106.42617078447563 },
        { lat: 23.231446942829862, lng: -106.42618419552004 },
        { lat: 23.231392718698633, lng: -106.42619492435554 },
        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 1 v4
    [
        { lat: 23.23196923163086, lng: -106.42297557745351 },
        { lat: 23.232012495438486, lng: -106.42306106093575 },
        { lat: 23.232042072102743, lng: -106.42309324744232 },
        { lat: 23.232081507644875, lng: -106.42313348057553 },
        { lat: 23.232140660936228, lng: -106.42317907812652 },
        { lat: 23.232162843413732, lng: -106.42323272230414 },
        { lat: 23.232258967440284, lng: -106.42326490881071 },
        { lat: 23.23228361462326, lng: -106.4233668328271 },
        { lat: 23.232266361601138, lng: -106.42343120584025 },
        { lat: 23.232256502730337, lng: -106.42348753222674 },
        { lat: 23.23227129103532, lng: -106.42351435428722 },
        { lat: 23.23227129103532, lng: -106.42370479111777 },
        { lat: 23.232300867642227, lng: -106.42387377027731 },
        { lat: 23.23232551480964, lng: -106.42415003779206 },
        { lat: 23.232327979526133, lng: -106.42428951265389 },
        { lat: 23.232347697256426, lng: -106.42444508076898 },
        { lat: 23.232362485552223, lng: -106.42463283539067 },
        { lat: 23.232362485552223, lng: -106.42476158141694 },
        { lat: 23.23237727384638, lng: -106.42487959860773 },
        { lat: 23.232313191226503, lng: -106.42492787836758 },
        { lat: 23.232236784986586, lng: -106.4249761581558 },
        { lat: 23.23222692611361, lng: -106.42508881092881 },
        { lat: 23.232135731504105, lng: -106.42519878149294 },
        { lat: 23.23210615486061, lng: -106.42539726495015 },
        { lat: 23.23211108430164, lng: -106.42553405760309 },
        { lat: 23.232125872623662, lng: -106.42561988828729 },
        { lat: 23.232125872623662, lng: -106.4256896257182 },
        { lat: 23.23211108430164, lng: -106.42573522326916 },
        { lat: 23.232066719325754, lng: -106.42574058768692 },
        { lat: 23.2320174248908, lng: -106.42575131652247 },
        { lat: 23.231908977069825, lng: -106.42576472756686 },
        { lat: 23.231839964774238, lng: -106.42577009198462 },
        { lat: 23.231770952442968, lng: -106.42577545640239 },
        { lat: 23.23170686953198, lng: -106.42579423186456 },
        { lat: 23.231646725772936, lng: -106.42577630016079 },
        { lat: 23.231583512012428, lng: -106.42580562113862 },
        { lat: 23.231517189346267, lng: -106.42580674886855 },
        { lat: 23.231442576307458, lng: -106.42582592027713 },
        { lat: 23.231341019600958, lng: -106.42590147819526 },
        { lat: 23.2313047493311, lng: -106.42593418236282 },
        { lat: 23.23129853156955, lng: -106.42603906124508 },
        { lat: 23.2313047493311, lng: -106.4261157468794 },
        { lat: 23.23131096709234, lng: -106.42615634515639 },
        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 1 v6
    [
        { lat: 23.23196923163086, lng: -106.42297557745351 },
        { lat: 23.232012495438486, lng: -106.42306106093575 },
        { lat: 23.232042072102743, lng: -106.42309324744232 },
        { lat: 23.232081507644875, lng: -106.42313348057553 },
        { lat: 23.232140660936228, lng: -106.42317907812652 },
        { lat: 23.232162843413732, lng: -106.42323272230414 },
        { lat: 23.232258967440284, lng: -106.42326490881071 },
        { lat: 23.23236987969262, lng: -106.4233668327482 },
        { lat: 23.23246766503822, lng: -106.4237010904293 },
        { lat: 23.23248857882744, lng: -106.42387178515726 },
        { lat: 23.23249903572081, lng: -106.4240462731014 },
        { lat: 23.232526920765817, lng: -106.42427007285583 },
        { lat: 23.232523435135512, lng: -106.42441800828674 },
        { lat: 23.232544348915983, lng: -106.42457732336615 },
        { lat: 23.232554805804995, lng: -106.42474801809412 },
        { lat: 23.232558291434486, lng: -106.42489216030883 },
        { lat: 23.232568748322404, lng: -106.42499457714561 },
        { lat: 23.23248509319613, lng: -106.42507423468533 },
        { lat: 23.232457208142392, lng: -106.42518423795445 },
        { lat: 23.23234218223413, lng: -106.425324586953 },
        { lat: 23.23233172532847, lng: -106.42544217665449 },
        { lat: 23.232338696598994, lng: -106.4255711460045 },
        { lat: 23.232268983877265, lng: -106.42566976962509 },
        { lat: 23.23218881420226, lng: -106.42569632213834 },
        { lat: 23.232105158837864, lng: -106.42575701359716 },
        { lat: 23.232066719325754, lng: -106.42574058768692 },
        { lat: 23.2320174248908, lng: -106.42575131652247 },
        { lat: 23.231908977069825, lng: -106.42576472756686 },
        { lat: 23.231839964774238, lng: -106.42577009198462 },
        { lat: 23.231770952442968, lng: -106.42577545640239 },
        { lat: 23.23170686953198, lng: -106.42579423186456 },
        { lat: 23.231646725772936, lng: -106.42577630016079 },
        { lat: 23.231583512012428, lng: -106.42580562113862 },
        { lat: 23.231517189346267, lng: -106.42580674886855 },
        { lat: 23.231442576307458, lng: -106.42582592027713 },
        { lat: 23.231341019600958, lng: -106.42590147819526 },
        { lat: 23.2313047493311, lng: -106.42593418236282 },
        { lat: 23.23129853156955, lng: -106.42603906124508 },
        { lat: 23.2313047493311, lng: -106.4261157468794 },
        { lat: 23.23131096709234, lng: -106.42615634515639 },
        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],

    // Ruta existente a UAGYNM desde Entrada 1 v6
    [
        { lat: 23.23196923163086, lng: -106.42297557745351 },
        { lat: 23.232012495438486, lng: -106.42306106093575 },
        { lat: 23.232042072102743, lng: -106.42309324744232 },
        { lat: 23.232081507644875, lng: -106.42313348057553 },
        { lat: 23.232140660936228, lng: -106.42317907812652 },
        { lat: 23.232162843413732, lng: -106.42323272230414 },
        { lat: 23.232258967440284, lng: -106.42326490881071 },
        { lat: 23.23236987969262, lng: -106.4233668327482 },
        { lat: 23.232478327139102, lng: -106.42353581190771 },
        { lat: 23.232599098055356, lng: -106.42371015548498 },
        { lat: 23.23261231867989, lng: -106.42382436995504 },
        { lat: 23.23257920520949, lng: -106.42384143942785 },
        { lat: 23.23263148963269, lng: -106.42392109696755 },
        { lat: 23.23270468779075, lng: -106.42404437649331 },
        { lat: 23.232774400284914, lng: -106.4241600695867 },
        { lat: 23.232826684631643, lng: -106.42426817624774 },
        { lat: 23.23287025490495, lng: -106.4243554202198 },
        { lat: 23.23291731078412, lng: -106.42443507775953 },
        { lat: 23.232941710122358, lng: -106.42447869974556 },
        { lat: 23.232851083986446, lng: -106.42449007939409 },
        { lat: 23.232819713386604, lng: -106.42461146231174 },
        { lat: 23.23281274214118, lng: -106.42473663844558 },
        { lat: 23.232830170254033, lng: -106.42483905528236 },
        { lat: 23.232816227763944, lng: -106.42494905855149 },
        { lat: 23.2327221159177, lng: -106.42501733644268 },
        { lat: 23.23273605841763, lng: -106.42513871936033 },
        { lat: 23.23273954404237, lng: -106.42532079373683 },
        { lat: 23.232760457788995, lng: -106.42544596987065 },
        { lat: 23.23276394341312, lng: -106.42561287138246 },
        { lat: 23.232795314026063, lng: -106.42578735932659 },
        { lat: 23.232788342779383, lng: -106.42592391510894 },
        { lat: 23.23281274214118, lng: -106.42601874551336 },
        { lat: 23.232812397797524, lng: -106.4260742249265 },
        { lat: 23.232728597715447, lng: -106.4260581316732 },
        { lat: 23.232627544605318, lng: -106.42604203841992 },
        { lat: 23.232528956131468, lng: -106.4260447206288 },
        { lat: 23.23244762058572, lng: -106.42604740283768 },
        { lat: 23.23234163783051, lng: -106.42606081388209 },
        { lat: 23.232267696323557, lng: -106.42607690713537 },
        { lat: 23.232169107583896, lng: -106.42607154271762 },
        { lat: 23.232100095422812, lng: -106.42608227155314 },
        { lat: 23.2319891829463, lng: -106.42609568259755 },
        { lat: 23.231986718207843, lng: -106.42609031820918 },
        { lat: 23.23189305870973, lng: -106.42609836483582 },
        { lat: 23.231838834759742, lng: -106.42609836483582 },
        { lat: 23.23176242824735, lng: -106.42610909367136 },
        { lat: 23.231708204244296, lng: -106.42610909367136 },
        { lat: 23.231653980219193, lng: -106.42612518692464 },
        { lat: 23.231567714679347, lng: -106.42615469122234 },
        { lat: 23.231508561134067, lng: -106.42617078447563 },
        { lat: 23.231446942829862, lng: -106.42618419552004 },
        { lat: 23.231392718698633, lng: -106.42619492435554 },

        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],

    // Ruta existente a UAGYNM desde Entrada 1 v8
    [
        { lat: 23.23196923163086, lng: -106.42297557745351 },
        { lat: 23.232012495438486, lng: -106.42306106093575 },
        { lat: 23.232042072102743, lng: -106.42309324744232 },
        { lat: 23.232081507644875, lng: -106.42313348057553 },
        { lat: 23.232140660936228, lng: -106.42317907812652 },
        { lat: 23.232162843413732, lng: -106.42323272230414 },
        { lat: 23.232258967440284, lng: -106.42326490881071 },
        { lat: 23.23236987969262, lng: -106.4233668327482 },
        { lat: 23.232478327139102, lng: -106.42353581190771 },
        { lat: 23.232599098055356, lng: -106.42371015548498 },
        { lat: 23.23261231867989, lng: -106.42382436995504 },
        { lat: 23.23257920520949, lng: -106.42384143942785 },
        { lat: 23.23263148963269, lng: -106.42392109696755 },
        { lat: 23.23270468779075, lng: -106.42404437649331 },
        { lat: 23.232774400284914, lng: -106.4241600695867 },
        { lat: 23.232826684631643, lng: -106.42426817624774 },
        { lat: 23.23287025490495, lng: -106.4243554202198 },
        { lat: 23.23291731078412, lng: -106.42443507775953 },
        { lat: 23.232941710122358, lng: -106.42447869974556 },
        { lat: 23.232851083986446, lng: -106.42449007939409 },
        { lat: 23.232819713386604, lng: -106.42461146231174 },
        { lat: 23.23281274214118, lng: -106.42473663844558 },
        { lat: 23.232830170254033, lng: -106.42483905528236 },
        { lat: 23.232816227763944, lng: -106.42494905855149 },
        { lat: 23.2327221159177, lng: -106.42501733644268 },
        { lat: 23.23273605841763, lng: -106.42513871936033 },
        { lat: 23.23273954404237, lng: -106.42532079373683 },
        { lat: 23.232760457788995, lng: -106.42544596987065 },

        { lat: 23.232753871306084, lng: -106.42553276147834 },
        { lat: 23.2326834040901, lng: -106.42554178331766 },
        { lat: 23.23262329967059, lng: -106.42553727239799 },
        { lat: 23.232515526160917, lng: -106.42555531607665 },
        { lat: 23.232442986249644, lng: -106.42560268073315 },
        { lat: 23.232368373728345, lng: -106.42561395803233 },
        { lat: 23.232314486881467, lng: -106.42562974625115 },
        { lat: 23.232268983877265, lng: -106.42566976962509 },
        { lat: 23.23218881420226, lng: -106.42569632213834 },
        { lat: 23.232105158837864, lng: -106.42575701359716 },
        { lat: 23.232066719325754, lng: -106.42574058768692 },
        { lat: 23.2320174248908, lng: -106.42575131652247 },
        { lat: 23.231908977069825, lng: -106.42576472756686 },
        { lat: 23.231839964774238, lng: -106.42577009198462 },
        { lat: 23.231770952442968, lng: -106.42577545640239 },
        { lat: 23.23170686953198, lng: -106.42579423186456 },
        { lat: 23.231646725772936, lng: -106.42577630016079 },
        { lat: 23.231583512012428, lng: -106.42580562113862 },
        { lat: 23.231517189346267, lng: -106.42580674886855 },
        { lat: 23.231442576307458, lng: -106.42582592027713 },
        { lat: 23.231341019600958, lng: -106.42590147819526 },
        { lat: 23.2313047493311, lng: -106.42593418236282 },
        { lat: 23.23129853156955, lng: -106.42603906124508 },
        { lat: 23.2313047493311, lng: -106.4261157468794 },
        { lat: 23.23131096709234, lng: -106.42615634515639 },

   

        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],



    // Ruta existente a UAGYNM desde Entrada 2 v1
    [


        { lat: 23.231367138739593, lng: -106.42337598040392 },
        { lat: 23.23139363462972, lng: -106.42337061598614 },
        { lat: 23.2314373836461, lng: -106.42336927488172 },
        { lat: 23.231500850503537, lng: -106.42336659267283 },
        { lat: 23.23155384222546, lng: -106.42336323991174 },
        { lat: 23.23159081318177, lng: -106.42336391046396 },
        { lat: 23.231644615650243, lng: -106.42334159574486 },
        { lat: 23.2316885817435, lng: -106.42341735116464 },
        { lat: 23.231724487375583, lng: -106.42348433490423 },
        { lat: 23.231748668714204, lng: -106.42355929289855 },
        { lat: 23.23175013424973, lng: -106.42364222514756 },
        { lat: 23.23174720317865, lng: -106.42371399343997 },//
        { lat: 23.231750134249282, lng: -106.42378576176186 },
        { lat: 23.231755996391254, lng: -106.42388145281842 },
        { lat: 23.231760392997572, lng: -106.4239707644712 },
        { lat: 23.231764056836038, lng: -106.42406087354948 },
        { lat: 23.231770651745062, lng: -106.42412865471455 },
        { lat: 23.231775048350883, lng: -106.4242299277494 },
        { lat: 23.231777979421356, lng: -106.42432641623142 },
        { lat: 23.23178530709725, lng: -106.42440695620402 },//
        { lat: 23.23178897093414, lng: -106.42447234511782 },
        { lat: 23.231790436469232, lng: -106.42456245419609 },
        { lat: 23.231787505399026, lng: -106.42467010663471 },
        { lat: 23.23178091049086, lng: -106.42474107750168 },
        { lat: 23.231790436469232, lng: -106.42484952736577 },
        { lat: 23.23179410030688, lng: -106.4249157136799 },
        { lat: 23.23179556584212, lng: -106.42501858158094 },
        { lat: 23.23181095395902, lng: -106.4251031086809 },
        { lat: 23.231756729158295, lng: -106.42517886410069 },
        { lat: 23.23167246084318, lng: -106.42524824011669 },
        { lat: 23.2316819868293, lng: -106.42529050366667 },
        { lat: 23.23169078004641, lng: -106.42539257414903 },
        { lat: 23.231700306031215, lng: -106.42550421371503 },
        { lat: 23.231708366479367, lng: -106.4256246249612 },
        { lat: 23.231717159694977, lng: -106.42570117780645 },
        { lat: 23.231721556302567, lng: -106.42575938986585 },
        { lat: 23.231646725772936, lng: -106.42577630016079 },
        { lat: 23.231583512012428, lng: -106.42580562113862 },
        { lat: 23.231517189346267, lng: -106.42580674886855 },
        { lat: 23.231442576307458, lng: -106.42582592027713 },
        { lat: 23.231341019600958, lng: -106.42590147819526 },
        { lat: 23.2313047493311, lng: -106.42593418236282 },
        { lat: 23.23129853156955, lng: -106.42603906124508 },
        { lat: 23.2313047493311, lng: -106.4261157468794 },
        { lat: 23.23131096709234, lng: -106.42615634515639 },
        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],


    // Rutas desde Entrada 3
    // Ruta existente a UAGYNM desde Entrada 3
    [
        { lat: 23.230448502004883, lng: -106.42674029892541 }, // Entrada 3
        { lat: 23.230520026617633, lng: -106.42672782641371 },
        { lat: 23.23058041297535, lng: -106.42670100432491 },
        { lat: 23.23064696117467, lng: -106.42668222886273 },
        { lat: 23.23069009424911, lng: -106.42665004235616 },
        { lat: 23.230720903579456, lng: -106.42659237486521 },
        { lat: 23.23077512798359, lng: -106.42652531964318 },
        { lat: 23.230839211341905, lng: -106.42654677731423 },
        { lat: 23.230947660032037, lng: -106.4265588472542 },
        { lat: 23.231016672788964, lng: -106.42655750614975 },
        { lat: 23.231086917879928, lng: -106.42656287056752 },
        { lat: 23.231110332902023, lng: -106.42656689388085 },
        { lat: 23.23118550741891, lng: -106.42653336626982 },
        { lat: 23.2312298726877, lng: -106.42650788528546 },
        { lat: 23.231293955827685, lng: -106.42647033436113 },
        { lat: 23.231344482902028, lng: -106.42644753558045 },
        { lat: 23.231398707052854, lng: -106.42642339570054 },//
        { lat: 23.231386383384137, lng: -106.42634024722523 },
        { lat: 23.231382686283307, lng: -106.4262731920032 },
        { lat: 23.231378989182364, lng: -106.42621820672112 },
        { lat: 23.231366665511842, lng: -106.4261779735879 },
        { lat: 23.23133462396315, lng: -106.4261779735879 },
        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],
    // Rutas desde Entrada 4
    // Ruta existente a UAGYNM desde Entrada 4
    [
        { lat: 23.231243648265867, lng: -106.42799959886528 },
        { lat: 23.231206014982003, lng: -106.42770567856205 },
        { lat: 23.231228197614836, lng: -106.4276513638322 },
        { lat: 23.231271946685442, lng: -106.4276346000267 },
        { lat: 23.23130830153602, lng: -106.42763594113113 },
        { lat: 23.231303372065337, lng: -106.42759302578902 },
        { lat: 23.231326170865728, lng: -106.42748439632935 },
        { lat: 23.231320009028167, lng: -106.42738716625739 },
        { lat: 23.23131631192549, lng: -106.427294630051 },
        { lat: 23.231326787049458, lng: -106.42721014047125 },
        { lat: 23.231333565070422, lng: -106.42715381408473 },
        { lat: 23.231330484151258, lng: -106.42711089870228 },
        { lat: 23.2313243223139, lng: -106.42705121955468 },
        { lat: 23.231318776660032, lng: -106.42699623427261 },
        { lat: 23.23131138245451, lng: -106.42694795451276 },
        { lat: 23.231298442593875, lng: -106.42689498088737 },
        { lat: 23.231268865764854, lng: -106.42684536002305 },
        { lat: 23.23124298603408, lng: -106.42679842136764 },
        { lat: 23.23121710629828, lng: -106.42675215326443 },
        { lat: 23.2311832161605, lng: -106.42670052074347 },
        { lat: 23.231154255490473, lng: -106.42665022932695 },
        { lat: 23.231128375737484, lng: -106.42660731398485 },
        { lat: 23.23118550741891, lng: -106.42653336626982 },
        { lat: 23.2312298726877, lng: -106.42650788528546 },
        { lat: 23.231293955827685, lng: -106.42647033436113 },
        { lat: 23.231344482902028, lng: -106.42644753558045 },
        { lat: 23.231398707052854, lng: -106.42642339570054 },
        { lat: 23.231386383384137, lng: -106.42634024722523 },
        { lat: 23.231382686283307, lng: -106.4262731920032 },
        { lat: 23.231378989182364, lng: -106.42621820672112 },
        { lat: 23.231366665511842, lng: -106.4261779735879 },
        { lat: 23.23133462396315, lng: -106.4261779735879 },
        { lat: 23.2313054059438, lng: -106.42617273640757 } // UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 4
    [
        { lat: 23.231243648265867, lng: -106.42799959886528 },
        { lat: 23.23125962300445, lng: -106.42797322885767 },
        { lat: 23.23135821241587, lng: -106.4279088558445 },
        { lat: 23.231444478091138, lng: -106.4278686227113 },
        { lat: 23.23153320844181, lng: -106.42780693190703 },
        { lat: 23.231619474003978, lng: -106.42772914784946 },
        { lat: 23.23170820423832, lng: -106.42765941041856 },
        { lat: 23.231774751875374, lng: -106.42762185949424 },
        { lat: 23.231828975851396, lng: -106.42757089752548 },//
        { lat: 23.231787075508223, lng: -106.42749847788569 },
        { lat: 23.231720527877325, lng: -106.42742069382814 },
        { lat: 23.231681092228527, lng: -106.42734827418835 },
        { lat: 23.231651515484284, lng: -106.42724903245976 },
        { lat: 23.23162933292181, lng: -106.42713906189562 },
        { lat: 23.2316490507553, lng: -106.4270264091226 },//
        { lat: 23.23173285151517, lng: -106.42698885819827 },
        { lat: 23.231814187496486, lng: -106.42699422261603 },//
        { lat: 23.23178214605522, lng: -106.42681719682987 },
        { lat: 23.231777216602026, lng: -106.42670990847463 },
        { lat: 23.231772287148658, lng: -106.42660798453713 },
        { lat: 23.23176489296828, lng: -106.42646046304868 },
        { lat: 23.2317476398791, lng: -106.42638267899113 },
        { lat: 23.23162933292181, lng: -106.42639340782665 },
        { lat: 23.23156278521226, lng: -106.42640950107993 },
        { lat: 23.23149130800578, lng: -106.4264148654977 },
        { lat: 23.231398707052854, lng: -106.42642339570054 },
        { lat: 23.231386383384137, lng: -106.42634024722523 },
        { lat: 23.231382686283307, lng: -106.4262731920032 },
        { lat: 23.231378989182364, lng: -106.42621820672112 },
        { lat: 23.231366665511842, lng: -106.4261779735879 },
        { lat: 23.23133462396315, lng: -106.4261779735879 },
        { lat: 23.2313054059438, lng: -106.42617273640757 }// UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 4
    [
        { lat: 23.231243648265867, lng: -106.42799959886528 },
        { lat: 23.23125962300445, lng: -106.42797322885767 },
        { lat: 23.23135821241587, lng: -106.4279088558445 },
        { lat: 23.231444478091138, lng: -106.4278686227113 },
        { lat: 23.23153320844181, lng: -106.42780693190703 },
        { lat: 23.231619474003978, lng: -106.42772914784946 },
        { lat: 23.23170820423832, lng: -106.42765941041856 },
        { lat: 23.231774751875374, lng: -106.42762185949424 },
        { lat: 23.231828975851396, lng: -106.42757089752548 },//
        { lat: 23.231868411462468, lng: -106.42754675763166 },
        { lat: 23.231957141531332, lng: -106.42749043124516 },
        { lat: 23.232026153766334, lng: -106.42744215148531 },
        { lat: 23.232100095407088, lng: -106.4273697318455 },
        { lat: 23.232087771803148, lng: -106.42729731220571 },
        { lat: 23.232077912919166, lng: -106.42717661280605 },
        { lat: 23.232075448198056, lng: -106.42708273549522 },
        { lat: 23.232060659870452, lng: -106.42699154039326 },
        { lat: 23.232060659870452, lng: -106.42696740051332 },
        { lat: 23.231986718207843, lng: -106.4269727649311 },
        { lat: 23.231897988158636, lng: -106.42698081155774 },
        { lat: 23.231814187496486, lng: -106.42699422261603 },//
        { lat: 23.23178214605522, lng: -106.42681719682987 },
        { lat: 23.231777216602026, lng: -106.42670990847463 },
        { lat: 23.231772287148658, lng: -106.42660798453713 },
        { lat: 23.23176489296828, lng: -106.42646046304868 },
        { lat: 23.2317476398791, lng: -106.42638267899113 },
        { lat: 23.23162933292181, lng: -106.42639340782665 },
        { lat: 23.23156278521226, lng: -106.42640950107993 },
        { lat: 23.23149130800578, lng: -106.4264148654977 },
        { lat: 23.231398707052854, lng: -106.42642339570054 },
        { lat: 23.231386383384137, lng: -106.42634024722523 },
        { lat: 23.231382686283307, lng: -106.4262731920032 },
        { lat: 23.231378989182364, lng: -106.42621820672112 },
        { lat: 23.231366665511842, lng: -106.4261779735879 },
        { lat: 23.23133462396315, lng: -106.4261779735879 },
        { lat: 23.2313054059438, lng: -106.42617273640757 }// UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 4
    [
        { lat: 23.231243648265867, lng: -106.42799959886528 },
        { lat: 23.23125962300445, lng: -106.42797322885767 },
        { lat: 23.23135821241587, lng: -106.4279088558445 },
        { lat: 23.231444478091138, lng: -106.4278686227113 },
        { lat: 23.23153320844181, lng: -106.42780693190703 },
        { lat: 23.231619474003978, lng: -106.42772914784946 },
        { lat: 23.23170820423832, lng: -106.42765941041856 },
        { lat: 23.231774751875374, lng: -106.42762185949424 },
        { lat: 23.231828975851396, lng: -106.42757089752548 },//
        { lat: 23.231787075508223, lng: -106.42749847788569 },
        { lat: 23.231720527877325, lng: -106.42742069382814 },
        { lat: 23.231681092228527, lng: -106.42734827418835 },
        { lat: 23.231651515484284, lng: -106.42724903245976 },
        { lat: 23.23162933292181, lng: -106.42713906189562 },
        { lat: 23.2316490507553, lng: -106.4270264091226 },
        { lat: 23.231604685631815, lng: -106.4269727649311 },
        { lat: 23.231567714679347, lng: -106.4269164385446 },
        { lat: 23.231513490597173, lng: -106.42691912075347 },
        { lat: 23.231439548631453, lng: -106.42692180296234 },
        { lat: 23.23140997183369, lng: -106.42691912075347 },
        { lat: 23.231407507100254, lng: -106.42684938332256 },
        { lat: 23.231392718698633, lng: -106.42675014159396 },
        { lat: 23.231390253964882, lng: -106.42665626428311 },
        { lat: 23.231390253964882, lng: -106.42654897592786 },
        { lat: 23.231380395029387, lng: -106.42646314524367 },
        { lat: 23.231398707052854, lng: -106.42642339570054 },
        { lat: 23.231386383384137, lng: -106.42634024722523 },
        { lat: 23.231382686283307, lng: -106.4262731920032 },
        { lat: 23.231378989182364, lng: -106.42621820672112 },
        { lat: 23.231366665511842, lng: -106.4261779735879 },
        { lat: 23.23133462396315, lng: -106.4261779735879 },
        { lat: 23.2313054059438, lng: -106.42617273640757 }// UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 4
    [
        { lat: 23.231243648265867, lng: -106.42799959886528 },
        { lat: 23.23125962300445, lng: -106.42797322885767 },
        { lat: 23.23135821241587, lng: -106.4279088558445 },
        { lat: 23.231444478091138, lng: -106.4278686227113 },
        { lat: 23.23153320844181, lng: -106.42780693190703 },
        { lat: 23.231619474003978, lng: -106.42772914784946 },
        { lat: 23.23170820423832, lng: -106.42765941041856 },
        { lat: 23.231774751875374, lng: -106.42762185949424 },
        { lat: 23.231828975851396, lng: -106.42757089752548 },//
        { lat: 23.231868411462468, lng: -106.42754675763166 },
        { lat: 23.231957141531332, lng: -106.42749043124516 },
        { lat: 23.232026153766334, lng: -106.42744215148531 },
        { lat: 23.232100095407088, lng: -106.4273697318455 },
        { lat: 23.232087771803148, lng: -106.42729731220571 },
        { lat: 23.232077912919166, lng: -106.42717661280605 },
        { lat: 23.232075448198056, lng: -106.42708273549522 },
        { lat: 23.232060659870452, lng: -106.42699154039326 },
        { lat: 23.232060659870452, lng: -106.42696740051332 },
        { lat: 23.23205573042755, lng: -106.42690302750019 },
        { lat: 23.232045871541203, lng: -106.426771599265 },
        { lat: 23.232031083210327, lng: -106.42667235753639 },
        { lat: 23.232026153766334, lng: -106.42655970476338 },
        { lat: 23.23202122432215, lng: -106.42647119187029 },
        { lat: 23.23200397126611, lng: -106.42635853909731 },
        { lat: 23.231996577098553, lng: -106.42625125074204 },
        { lat: 23.23198918293059, lng: -106.42612518692464 },
        { lat: 23.231986718207843, lng: -106.42609031820918 },
        { lat: 23.23189305870973, lng: -106.42609836483582 },
        { lat: 23.231838834759742, lng: -106.42609836483582 },
        { lat: 23.23176242824735, lng: -106.42610909367136 },
        { lat: 23.231708204244296, lng: -106.42610909367136 },
        { lat: 23.231653980219193, lng: -106.42612518692464 },
        { lat: 23.231567714679347, lng: -106.42615469122234 },
        { lat: 23.231508561134067, lng: -106.42617078447563 },
        { lat: 23.231446942829862, lng: -106.42618419552004 },
        { lat: 23.231392718698633, lng: -106.42619492435554 },
        { lat: 23.2313054059438, lng: -106.42617273640757 }// UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 4
    [
        { lat: 23.231243648265867, lng: -106.42799959886528 },
        { lat: 23.23125962300445, lng: -106.42797322885767 },
        { lat: 23.23135821241587, lng: -106.4279088558445 },
        { lat: 23.231444478091138, lng: -106.4278686227113 },
        { lat: 23.23153320844181, lng: -106.42780693190703 },
        { lat: 23.231619474003978, lng: -106.42772914784946 },
        { lat: 23.23170820423832, lng: -106.42765941041856 },
        { lat: 23.231774751875374, lng: -106.42762185949424 },
        { lat: 23.231828975851396, lng: -106.42757089752548 },//
        { lat: 23.231868411462468, lng: -106.42754675763166 },
        { lat: 23.231957141531332, lng: -106.42749043124516 },
        { lat: 23.232026153766334, lng: -106.42744215148531 },
        { lat: 23.232100095407088, lng: -106.4273697318455 },
        { lat: 23.232181431164623, lng: -106.42732681650341 },
        { lat: 23.23225044328366, lng: -106.42728926557906 },
        { lat: 23.23229480819848, lng: -106.42724366802808 },
        { lat: 23.232260302154895, lng: -106.42713637967285 },
        { lat: 23.23225044328366, lng: -106.42700226922878 },
        { lat: 23.232255372719372, lng: -106.42686815878471 },
        { lat: 23.232255372719372, lng: -106.4267581882206 },
        { lat: 23.232243049129753, lng: -106.42664821765646 },
        { lat: 23.232230725539004, lng: -106.42647655628807 },
        { lat: 23.232233190257237, lng: -106.42637463235059 },
        { lat: 23.232181431164623, lng: -106.42635317467953 },
        { lat: 23.232122277891335, lng: -106.42636658572394 },
        { lat: 23.232060659870452, lng: -106.42636658572394 },
        { lat: 23.231964535701064, lng: -106.42636926793283 },
        { lat: 23.231912776504267, lng: -106.42636658572394 },
        { lat: 23.231826511131665, lng: -106.42636926793283 },
        { lat: 23.23177721660801, lng: -106.42637999676836 },
        { lat: 23.23162933292181, lng: -106.42639340782665 },
        { lat: 23.23156278521226, lng: -106.42640950107993 },
        { lat: 23.23149130800578, lng: -106.4264148654977 },
        { lat: 23.231398707052854, lng: -106.42642339570054 },
        { lat: 23.231386383384137, lng: -106.42634024722523 },
        { lat: 23.231382686283307, lng: -106.4262731920032 },
        { lat: 23.231378989182364, lng: -106.42621820672112 },
        { lat: 23.231366665511842, lng: -106.4261779735879 },
        { lat: 23.23133462396315, lng: -106.4261779735879 },
        { lat: 23.2313054059438, lng: -106.42617273640757 }// UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 4
    [
        { lat: 23.231243648265867, lng: -106.42799959886528 },
        { lat: 23.23125962300445, lng: -106.42797322885767 },
        { lat: 23.23135821241587, lng: -106.4279088558445 },
        { lat: 23.231444478091138, lng: -106.4278686227113 },
        { lat: 23.23153320844181, lng: -106.42780693190703 },
        { lat: 23.231619474003978, lng: -106.42772914784946 },
        { lat: 23.23170820423832, lng: -106.42765941041856 },
        { lat: 23.231774751875374, lng: -106.42762185949424 },
        { lat: 23.231828975851396, lng: -106.42757089752548 },//
        { lat: 23.231868411462468, lng: -106.42754675763166 },
        { lat: 23.231957141531332, lng: -106.42749043124516 },
        { lat: 23.232026153766334, lng: -106.42744215148531 },
        { lat: 23.232100095407088, lng: -106.4273697318455 },
        { lat: 23.232181431164623, lng: -106.42732681650341 },
        { lat: 23.23225044328366, lng: -106.42728926557906 },
        { lat: 23.23229480819848, lng: -106.42724366802808 },
        { lat: 23.23217650172619, lng: -106.42732145208564 },
        { lat: 23.232361355543052, lng: -106.4271846594327 },
        { lat: 23.232403255705965, lng: -106.42715247292612 },
        { lat: 23.232445155855707, lng: -106.42711760421066 },
        { lat: 23.232526491402968, lng: -106.42708809991296 },
        { lat: 23.232538814966404, lng: -106.42704518457087 },
        { lat: 23.232533885541176, lng: -106.42695130726004 },
        { lat: 23.23257332093799, lng: -106.42686815878471 },
        { lat: 23.232583179785387, lng: -106.42681987902486 },
        { lat: 23.232563462089892, lng: -106.4266884507897 },
        { lat: 23.23255606795331, lng: -106.42657579801669 },
        { lat: 23.23254374439147, lng: -106.42646850966143 },
        { lat: 23.232528956115758, lng: -106.42640145443939 },
        { lat: 23.232524026690143, lng: -106.42630757712855 },
        { lat: 23.23246980299647, lng: -106.42632098817298 },
        { lat: 23.23238846741468, lng: -106.42633171700848 },
        { lat: 23.232321920083617, lng: -106.42633708142625 },
        { lat: 23.232272625742905, lng: -106.42635049247066 },
        { lat: 23.232122277891335, lng: -106.42636658572394 },
        { lat: 23.232060659870452, lng: -106.42636658572394 },
        { lat: 23.231964535701064, lng: -106.42636926793283 },
        { lat: 23.231912776504267, lng: -106.42636658572394 },
        { lat: 23.231826511131665, lng: -106.42636926793283 },
        { lat: 23.23177721660801, lng: -106.42637999676836 },
        { lat: 23.23162933292181, lng: -106.42639340782665 },
        { lat: 23.23156278521226, lng: -106.42640950107993 },
        { lat: 23.23149130800578, lng: -106.4264148654977 },
        { lat: 23.231398707052854, lng: -106.42642339570054 },
        { lat: 23.231386383384137, lng: -106.42634024722523 },
        { lat: 23.231382686283307, lng: -106.4262731920032 },
        { lat: 23.231378989182364, lng: -106.42621820672112 },
        { lat: 23.231366665511842, lng: -106.4261779735879 },
        { lat: 23.23133462396315, lng: -106.4261779735879 },
        { lat: 23.2313054059438, lng: -106.42617273640757 }// UAGYNM
    ],
    // Ruta existente a UAGYNM desde Entrada 4
    [
        { lat: 23.231243648265867, lng: -106.42799959886528 },
        { lat: 23.23125962300445, lng: -106.42797322885767 },
        { lat: 23.23135821241587, lng: -106.4279088558445 },
        { lat: 23.231444478091138, lng: -106.4278686227113 },
        { lat: 23.23153320844181, lng: -106.42780693190703 },
        { lat: 23.231619474003978, lng: -106.42772914784946 },
        { lat: 23.23170820423832, lng: -106.42765941041856 },
        { lat: 23.231774751875374, lng: -106.42762185949424 },
        { lat: 23.231828975851396, lng: -106.42757089752548 },//
        { lat: 23.231868411462468, lng: -106.42754675763166 },
        { lat: 23.231957141531332, lng: -106.42749043124516 },
        { lat: 23.232026153766334, lng: -106.42744215148531 },
        { lat: 23.232100095407088, lng: -106.4273697318455 },
        { lat: 23.232181431164623, lng: -106.42732681650341 },
        { lat: 23.23225044328366, lng: -106.42728926557906 },
        { lat: 23.23229480819848, lng: -106.42724366802808 },
        { lat: 23.23217650172619, lng: -106.42732145208564 },
        { lat: 23.232361355543052, lng: -106.4271846594327 },
        { lat: 23.232403255705965, lng: -106.42715247292612 },
        { lat: 23.232445155855707, lng: -106.42711760421066 },
        { lat: 23.232526491402968, lng: -106.42708809991296 },
        { lat: 23.232652191712404, lng: -106.4269834937372 },
        { lat: 23.232728597715447, lng: -106.42691643851518 },
        { lat: 23.23283211545624, lng: -106.42684938329316 },
        { lat: 23.232913450767697, lng: -106.42678232807113 },
        { lat: 23.23300710954979, lng: -106.42671795505797 },
        { lat: 23.233095838861654, lng: -106.42665089983593 },
        { lat: 23.23317224461074, lng: -106.4265838446139 },
        { lat: 23.233273297308454, lng: -106.42652215380964 },
        { lat: 23.233369420535286, lng: -106.42645241637874 },
        { lat: 23.2334063909887, lng: -106.42639608999224 },
        { lat: 23.233475402474365, lng: -106.42632635256132 },
        { lat: 23.233527161065194, lng: -106.42622174641497 },
        { lat: 23.23356906086211, lng: -106.4261171402686 },
        { lat: 23.233591243102218, lng: -106.42603399179329 },
        { lat: 23.233500049424883, lng: -106.42603667400215 },
        { lat: 23.233403926292127, lng: -106.42604740283768 },
        { lat: 23.233334914769518, lng: -106.42605544946434 },
        { lat: 23.233199356317623, lng: -106.42606886050874 },
        { lat: 23.23308598005214, lng: -106.42607154271762 },
        { lat: 23.233002180141842, lng: -106.42609031817977 },
        { lat: 23.232903591944705, lng: -106.42608495376201 },
        { lat: 23.232812397797524, lng: -106.4260742249265 },
        { lat: 23.232728597715447, lng: -106.4260581316732 },
        { lat: 23.232627544605318, lng: -106.42604203841992 },
        { lat: 23.232528956131468, lng: -106.4260447206288 },
        { lat: 23.23244762058572, lng: -106.42604740283768 },
        { lat: 23.23234163783051, lng: -106.42606081388209 },
        { lat: 23.232267696323557, lng: -106.42607690713537 },
        { lat: 23.232169107583896, lng: -106.42607154271762 },
        { lat: 23.232100095422812, lng: -106.42608227155314 },
        { lat: 23.2319891829463, lng: -106.42609568259755 },
        { lat: 23.231986718207843, lng: -106.42609031820918 },
        { lat: 23.23189305870973, lng: -106.42609836483582 },
        { lat: 23.231838834759742, lng: -106.42609836483582 },
        { lat: 23.23176242824735, lng: -106.42610909367136 },
        { lat: 23.231708204244296, lng: -106.42610909367136 },
        { lat: 23.231653980219193, lng: -106.42612518692464 },
        { lat: 23.231567714679347, lng: -106.42615469122234 },
        { lat: 23.231508561134067, lng: -106.42617078447563 },
        { lat: 23.231446942829862, lng: -106.42618419552004 },
        { lat: 23.231392718698633, lng: -106.42619492435554 },
        { lat: 23.2313054059438, lng: -106.42617273640757 }// UAGYNM
    ],



];

function initMap() {
    const campusCenter = { lat: 23.2319822, lng: -106.425 }; // Centro aproximado del campus

    map = new google.maps.Map(document.getElementById('map'), {
        center: campusCenter,
        zoom: 17
    });

    const campusCoords = [
        { lat: 23.23125453442152, lng: -106.42803365428854 },
        { lat: 23.23387306581386, lng: -106.42616878279699 },
        { lat: 23.233473665166013, lng: -106.42486937917639 },
        { lat: 23.232318646324853, lng: -106.42304271565632 },
        { lat: 23.231332098698534, lng: -106.42282619152536 },
        { lat: 23.231481608421838, lng: -106.42504897701605 },
        { lat: 23.23134791081551, lng: -106.42565962142034 },
        { lat: 23.23107168477985, lng: -106.42597682666671 },
        { lat: 23.230564816459236, lng: -106.42637570665707 },
        { lat: 23.230460245973276, lng: -106.42673985538813 }
    ];

    uasPolygon = new google.maps.Polygon({
        paths: campusCoords,
        strokeColor: '#FF0000',
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: '#FF0000',
        fillOpacity: 0.35
    });
    uasPolygon.setMap(map);

    userMarker = new google.maps.Marker({
        position: userLocation,
        map: map,
        draggable: false, // Cambio aquí
        title: "Ubicación Actual"
    });

    entrances.forEach((entrance) => {
        new google.maps.Marker({
            position: entrance,
            map: map,
            label: {
                text: entrance.name,
                fontWeight: 'bold',
                color: '#5491F5', // Azul cielo
                className: 'custom-marker-label'
            }
        });
    });

    Object.entries(destinations).forEach(([name, coords]) => {
        const destinationMarker = new google.maps.Marker({
            position: coords,
            map: map,
            label: {
                text: coords.name,
                fontWeight: 'bold',
                color: '#000000', // Azul cielo
                className: 'custom-marker-label'
            }
        });

        destinationMarker.addListener('click', () => {
            updateFastestRoute(name);
        });
    });

    map.addListener('dragstart', () => {
        autoCenterEnabled = false; // Deshabilitar el centrado automático al arrastrar el mapa
    });

    trackUserLocation();
    drawStaticRoutes(); // Dibuja las rutas estáticas en verde
    displayDistances(); // Muestra las distancias de las rutas
}

function trackUserLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.watchPosition(
            function(position) {
                updateUserLocation(position.coords.latitude, position.coords.longitude);
            },
            function() {
                handleLocationError(true, map.getCenter());
            },
            {
                enableHighAccuracy: true,
                maximumAge: 0,
                timeout: 5000
            }
        );
    } else {
        // Browser doesn't support Geolocation
        handleLocationError(false, map.getCenter());
    }
}

function updateUserLocation(lat, lng) {
    userLocation = {
        lat: lat,
        lng: lng
    };
    userMarker.setPosition(userLocation);
    if (autoCenterEnabled) {
        map.setCenter(userLocation);
    }
    // No llamamos a updateFastestRoute aquí para evitar dibujar rutas automáticamente
}

function drawStaticRoutes() {
    routes.forEach(path => {
        new google.maps.Polyline({
            path: path,
            geodesic: true,
            strokeColor: '#00FF00',
            strokeOpacity: 0,
            icons: [{
                icon: {
                    path: google.maps.SymbolPath.CIRCLE,
                    scale: 4,
                    fillColor: '#00FF00',
                    fillOpacity: 0, // Relleno más claro
                    strokeColor: '#00FF00',
                    strokeWeight: 1
                },
                offset: '0',
                repeat: '10px'
            }]
        }).setMap(map);
    });
}

function calculateRouteDistance(route) {
    let distance = 0;
    for (let i = 0; i < route.length - 1; i++) {
        distance += google.maps.geometry.spherical.computeDistanceBetween(
            new google.maps.LatLng(route[i].lat, route[i].lng),
            new google.maps.LatLng(route[i + 1].lat, route[i + 1].lng)
        );
    }
    return distance;
}

function displayDistances() {
    const distancesContainer = document.getElementById('distances');
    distancesContainer.innerHTML = ""; // Limpiar el contenedor antes de agregar nuevas distancias
    routes.forEach((route, index) => {
        const distance = calculateRouteDistance(route);
        const distanceElement = document.createElement('div');
        distanceElement.textContent = `Ruta ${index + 1}: ${distance.toFixed(2)} metros`;
        distancesContainer.appendChild(distanceElement);
    });
}

function drawFastestRoute(destinationName) {
    if (destinationName !== 'UAGYNM') return; // Solo dibujar ruta si el destino es UAGYNM

    let minDistance = Infinity;
    let bestPath = null;
    let closestPointIndex = 0;

    routes.forEach(path => {
        path.forEach((point, index) => {
            const distanceToPoint = google.maps.geometry.spherical.computeDistanceBetween(
                new google.maps.LatLng(userLocation.lat, userLocation.lng),
                new google.maps.LatLng(point.lat, point.lng)
            );

            if (distanceToPoint < minDistance) {
                minDistance = distanceToPoint;
                bestPath = path;
                closestPointIndex = index;
            }
        });
    });

    // Selecciona la ruta desde el punto más cercano hasta el final
    if (bestPath) {
        const remainingPath = bestPath.slice(closestPointIndex);

        if (activePolyline) {
            activePolyline.setMap(null);
        }

        activePolyline = new google.maps.Polyline({
            path: remainingPath,
            geodesic: true,
            strokeColor: '#0000FF',
            strokeOpacity: 1.0,
            strokeWeight: 2,
            icons: [{
                icon: {
                    path: google.maps.SymbolPath.CIRCLE,
                    scale: 7,
                    fillColor: '#0000FF',
                    fillOpacity: 0.8, // Relleno más claro
                    strokeColor: '#0000FF',
                    strokeWeight: 1
                },
                offset: '0',
                repeat: '18px'
            }]
        });
        activePolyline.setMap(map);

        // Actualiza el camino restante y la ruta desde la ubicación actual del usuario al siguiente punto
        remainingPathGlobal = remainingPath;
        updateRoute(userLocation);
    }
}

function updateFastestRoute(destinationName) {
    if (destinationName !== 'UAGYNM') return; // Solo actualizar ruta si el destino es UAGYNM

    if (!isUserInsideCampus(userLocation, uasPolygon)) {
        const closestEntrance = findClosestEntrance(userLocation);

        // Dibujar la ruta desde la ubicación actual del usuario a la entrada más cercana
        const pathToClosestEntrance = [
            userLocation,
            { lat: closestEntrance.lat, lng: closestEntrance.lng }
        ];

        if (userToNextPointPolyline) {
            userToNextPointPolyline.setMap(null);
        }

        userToNextPointPolyline = new google.maps.Polyline({
            path: pathToClosestEntrance,
            geodesic: true,
            strokeColor: '#FF0000', // Color diferente para indicar la redirección
            strokeOpacity: 1.0,
            strokeWeight: 2
        });
        userToNextPointPolyline.setMap(map);

        // Actualizar la ubicación del usuario a la entrada más cercana
        userLocation = { lat: closestEntrance.lat, lng: closestEntrance.lng };
    }

    drawFastestRoute(destinationName); // Actualizar la ruta más rápida hacia UAGYNM
}

function updateRoute(currentLocation) {
    // Eliminar la línea anterior
    if (userToNextPointPolyline) {
        userToNextPointPolyline.setMap(null);
    }

    let closestPointIndex = 0;
    let minDistanceToNextPoint = Infinity;

    // Encontrar el punto más cercano al destino final que el usuario aún no ha cruzado
    remainingPathGlobal.forEach((point, index) => {
        const distanceToNextPoint = google.maps.geometry.spherical.computeDistanceBetween(
            new google.maps.LatLng(currentLocation.lat, currentLocation.lng),
            new google.maps.LatLng(point.lat, point.lng)
        );

        if (distanceToNextPoint < minDistanceToNextPoint) {
            minDistanceToNextPoint = distanceToNextPoint;
            closestPointIndex = index;
        }
    });

    // Actualizar el camino restante
    remainingPathGlobal = remainingPathGlobal.slice(closestPointIndex);

    if (activePolyline) {
        activePolyline.setPath(remainingPathGlobal);
    }

    // Dibujar la línea desde el marcador del usuario al siguiente punto de la ruta
    if (remainingPathGlobal.length > 0) {
        const userToNextPointPath = [
            currentLocation,
            remainingPathGlobal[0]
        ];

        userToNextPointPolyline = new google.maps.Polyline({
            path: userToNextPointPath,
            geodesic: true,
            strokeColor: '#00FF00',
            strokeOpacity: 0,
            icons: [{
                icon: {
                    path: google.maps.SymbolPath.CIRCLE,
                    scale: 4,
                    fillColor: '#00FF00',
                    fillOpacity: 0, // Relleno más claro
                    strokeColor: '#00FF00',
                    strokeWeight: 1
                },
                offset: '0',
                repeat: '10px'
            }]
        });
        userToNextPointPolyline.setMap(map);
    }
}

function isUserInsideCampus(userLocation, campusPolygon) {
    return google.maps.geometry.poly.containsLocation(
        new google.maps.LatLng(userLocation.lat, userLocation.lng), 
        campusPolygon
    );
}

function findClosestEntrance(userLocation) {
    let minDistance = Infinity;
    let closestEntrance = null;

    entrances.forEach(entrance => {
        const distance = google.maps.geometry.spherical.computeDistanceBetween(
            new google.maps.LatLng(userLocation.lat, userLocation.lng),
            new google.maps.LatLng(entrance.lat, entrance.lng)
        );

        if (distance < minDistance) {
            minDistance = distance;
            closestEntrance = entrance;
        }
    });

    return closestEntrance;
}

function handleLocationError(browserHasGeolocation, pos) {
    const infoWindow = new google.maps.InfoWindow({
        map: map
    });
    infoWindow.setPosition(pos);
    infoWindow.setContent(browserHasGeolocation ?
        'Error: The Geolocation service failed.' :
        'Error: Your browser doesn\'t support geolocation.');
}

window.onload = initMap;